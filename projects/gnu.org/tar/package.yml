distributable:
  url: https://ftp.gnu.org/gnu/tar/tar-{{ version.raw }}.tar.gz
  strip-components: 1

versions:
  url: https://ftp.gnu.org/gnu/tar/
  match: /tar-(\d+\.\d+(\.\d+)?)\.tar\.gz/
  strip:
    - /tar-/
    - /.tar.gz/

provides:
  - bin/tar

build:
  dependencies:
    tea.xyz/gx/cc: 'c99'
    tea.xyz/gx/make: '*'
    gnu.org/libiconv: '*'
  script:
    - ./configure $ARGS
    - make --jobs {{ hw.concurrency }} install
  env:
    ARGS:
      - --prefix={{ prefix }}
      - --with-libiconv-prefix={{ deps.gnu.org/libiconv.prefix }}

test:
  script:
    tar czvf test.tar.gz {{ prefix }}

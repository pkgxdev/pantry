distributable:
  url: https://ftp.gnu.org/gnu/coreutils/coreutils-{{ version.raw }}.tar.gz
  strip-components: 1

versions:
  url: https://ftp.gnu.org/gnu/coreutils/
  match: /coreutils-(\d+\.\d+(\.\d+)?)\.tar\.gz/
  strip:
    - /coreutils-/
    - /.tar.gz/

provides:
  - bin/[
  - bin/b2sum
  - bin/base32
  - bin/base64
  - bin/basename
  - bin/basenc
  - bin/cat
  # - bin/chcon # removed in 9.9
  - bin/chgrp
  - bin/chmod
  - bin/chown
  - bin/chroot
  - bin/cksum
  - bin/comm
  - bin/cp
  - bin/csplit
  - bin/cut
  - bin/date
  - bin/dd
  - bin/df
  - bin/dir
  - bin/dircolors
  - bin/dirname
  - bin/du
  - bin/echo
  - bin/env
  - bin/expand
  - bin/expr
  - bin/factor
  - bin/false
  - bin/fmt
  - bin/fold
  - bin/groups
  - bin/head
  - bin/hostid
  - bin/id
  - bin/install
  - bin/join
  - bin/kill
  - bin/link
  - bin/ln
  - bin/logname
  - bin/ls
  - bin/md5sum
  - bin/mkdir
  - bin/mkfifo
  - bin/mknod
  - bin/mktemp
  - bin/mv
  - bin/nice
  - bin/nl
  - bin/nohup
  - bin/nproc
  - bin/numfmt
  - bin/od
  - bin/paste
  - bin/pathchk
  - bin/pinky
  - bin/pr
  - bin/printenv
  - bin/printf
  - bin/ptx
  - bin/pwd
  - bin/readlink
  - bin/realpath
  - bin/rm
  - bin/rmdir
  # - bin/runcon # removed in 9.9
  - bin/seq
  - bin/sha1sum
  - bin/sha224sum
  - bin/sha256sum
  - bin/sha384sum
  - bin/sha512sum
  - bin/shred
  - bin/shuf
  - bin/sleep
  - bin/sort
  - bin/split
  - bin/stat
  - bin/stty
  - bin/sum
  - bin/sync
  - bin/tac
  - bin/tail
  - bin/tee
  - bin/test
  - bin/timeout
  - bin/touch
  - bin/tr
  - bin/true
  - bin/truncate
  - bin/tsort
  - bin/tty
  - bin/uname
  - bin/unexpand
  - bin/uniq
  - bin/unlink
  - bin/uptime
  - bin/users
  - bin/vdir
  - bin/wc
  - bin/who
  - bin/whoami
  - bin/yes

build:
  script:
    - ./configure --prefix={{ prefix }}
    - make --jobs {{ hw.concurrency }} install
  env:
    FORCE_UNSAFE_CONFIGURE: 1 # some gha runners run as root

test:
  - touch test-file
  - test "$(ls -1)" = "test-file"

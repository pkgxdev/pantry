distributable:
  url: "https://github.com/mxcl/swift-sh/archive/{{version}}.tar.gz"
  # this obscure option dictates how many components are removed from the
  # extracted tarball.
  strip-components: 1

versions:
  github: mxcl/swift-sh # reads github release tags

platforms:
  - darwin
  # - linux/x86-64

dependencies:
  # swift.org: 5

build:
  dependencies:
    tea.xyz/gx/cc: c99
    # swift.org: 5
    # apple.com/xcode: >=11
  script:
    - swift build --disable-sandbox -c release
    - mkdir -p {{prefix}}/bin
    - mv $(swift build --configuration release --show-bin-path)/swift-sh {{prefix}}/bin

provides:
  - bin/swift-sh

test:
  - echo "#!/usr/bin/env swift sh" > test.swift
  - swift-sh eject test.swift
  - test -e Test/Package.swift

distributable:
  url: https://github.com/pranshuparmar/witr/archive/refs/tags/v{{version}}.tar.gz
  strip-components: 1

display-name: why-is-this-running

versions:
  github: pranshuparmar/witr/releases

build:
  dependencies:
    go.dev: ^1.25
    git-scm.org: "*"
  script:
    - mkdir -p "{{prefix}}"/bin
    - go build -ldflags "-X main.version=v{{version}} -X main.commit=$(git rev-parse --short HEAD) -X 'main.buildDate=$(date +%Y-%m-%d)'" -o "{{prefix}}"/bin/witr ./cmd/witr
  env:
    CGO_ENABLED: 0

provides:
  - bin/witr

test:
  script:
    - witr --version | grep v{{version}}

distributable:
  url: https://github.com/realm/SwiftLint/archive/refs/tags/{{version}}.tar.gz
  strip-components: 1

versions:
  github: realm/SwiftLint/releases/tags

warnings:
  - vendored

build:
  dependencies:
    curl.se: '*'
    info-zip.org/unzip: '*'
  working-directory: vendor
  script:
    - run: |
        curl -Lfo swiftlint.zip "https://github.com/realm/SwiftLint/releases/download/{{version}}/portable_swiftlint.zip"
        unzip -o swiftlint.zip
        mkdir -p "{{prefix}}/bin"
        mv swiftlint "{{prefix}}/bin"
      if: darwin

    - run: |
        sudo apt-get update
        sudo apt-get install unzip
        curl -Lfo swiftlint.zip "https://github.com/realm/SwiftLint/releases/download/{{version}}/swiftlint_linux.zip"
        unzip -o swiftlint.zip
        mkdir -p "{{prefix}}/bin"
        mv swiftlint "{{prefix}}/bin"
      if: linux

provides:
  - bin/swiftlint

test:
  - test "$(swiftlint --version)" = {{version}}

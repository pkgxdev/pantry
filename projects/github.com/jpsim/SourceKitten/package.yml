distributable:
  url: git+https://github.com/jpsim/SourceKitten.git
  ref: ${{version.tag}}

versions:
  github: jpsim/SourceKitten

platforms:
  - darwin

build:
  - patch -p1 < props/patch.diff
  - make prefix_install PREFIX={{prefix}} TEMPORARY_FOLDER=$PWD/SourceKitten.dst --jobs={{hw.concurrency}}

provides:
  - bin/sourcekitten

test:
  env: 
    IN_PROCESS_SOURCEKIT: YES
  script:
    - sourcekitten version | grep {{version}}
    - sourcekitten syntax --text "import Foundation"
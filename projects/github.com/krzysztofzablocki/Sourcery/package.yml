distributable:
  url: https://github.com/krzysztofzablocki/Sourcery/releases/download/{{version}}/Sourcery-{{version}}.zip

versions:
  github: krzysztofzablocki/Sourcery

platforms:
  - darwin

provides:
  - bin/sourcery

warnings:
  - vendored

build:
  working-directory: ${{prefix}}/bin
  script:
    # zip format keeps changing.
    - test -f "$SRCROOT"/bin/sourcery && install "$SRCROOT"/bin/sourcery .
    - test -f "$SRCROOT"/sourcery-{{version}}/bin/sourcery && install "$SRCROOT"/sourcery-{{version}}/bin/sourcery .
    - test -f sourcery

test:
  - run: test "$(sourcery --version)" = "{{version}}"
    if: <2.1.4
  # 2.1.4 has the wrong version
  - run: sourcery --version
    if: 2.1.4

display-name: Sourcery

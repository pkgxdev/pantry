distributable:
  url: https://github.com/bcicen/ctop/archive/refs/tags/v{{version}}.tar.gz
  strip-components: 1

display-name: ctop

versions:
  github: bcicen/ctop

build:
  dependencies:
    go.dev: ^1.18
    git-scm.org: "*"

  script: |
    go mod download
    go build -tags release -ldflags="$GO_LDFLAGS" -o "$BUILDLOC"
  env:
    BUILDLOC: "{{prefix}}/bin/ctop"
    BUILD: "pkgx"
    GO_LDFLAGS:
      - -s
      - -w
      - -X main.version={{version}}
      - -X main.build="$BUILD"

provides:
  - bin/ctop

test: test "$(ctop -v | awk '{print $3}')" = {{version}},

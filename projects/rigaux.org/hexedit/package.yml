distributable:
  url: https://github.com/pixel/hexedit/archive/refs/tags/{{version.raw}}.tar.gz
  strip-components: 1

versions:
  github: pixel/hexedit/tags

dependencies:
  invisible-island.net/ncurses: 6

build:
  dependencies:
    gnu.org/autoconf: "*"
  script:
    # hexedit is a TUI with no --version flag; patch one in for testing
    - run: sed -i -f $PROP hexedit.c
      prop: |
        /streq(\*argv, "-s")/i\
            if (streq(*argv, "-V") || streq(*argv, "--version")) { puts("hexedit {{version}}"); exit(0); } else
    - ./autogen.sh
    - ./configure --prefix={{prefix}}
    - make
    - make install

test: test "$(hexedit --version)" = "hexedit {{version}}"

provides:
  - bin/hexedit

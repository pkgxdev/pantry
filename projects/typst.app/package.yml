distributable:
  url: https://github.com/typst/typst/archive/refs/tags/v{{ version }}.tar.gz
  strip-components: 1

versions:
  github: typst/typst/releases/tags

build:
  dependencies:
    rust-lang.org: ^1.61
    rust-lang.org/cargo: ^0.65
  script: |
    cargo install --path cli --locked --root {{prefix}}
  env:
    TYPST_VERSION: ${{ version }}

provides:
  - bin/typst

test:
  fixture: |
    Total displaced soil by glacial flow:

    $ 7.32 beta +
      sum_(i=0)^nabla Q_i / 2 $
  script: |
    cp $FIXTURE test.typ
    typst compile test.typ
    test -s test.pdf

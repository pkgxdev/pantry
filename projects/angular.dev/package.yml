distributable: ~
versions:
  github: angular/angular
dependencies:
  nodejs.org: ^20
build:
  dependencies:
    npmjs.com: ^10
    curl.se: '*'
  script:
    - curl -L https://registry.npmjs.org/@angular/cli/-/cli-{{version}}.tgz --output cli-{{version}}.tgz
    - npm i $ARGS
    - run: ln -s ../libexec/bin/ng ng
      working-directory: "{{prefix}}/bin"
  env:
    ARGS:
      - -ddd
      - --global
      - --build-from-source
      - --prefix={{prefix}}/libexec
      - --unsafe-perm
      - cli-{{version}}.tgz
provides:
  - bin/ng
test:
  script:
    - ng new angular-test --skip-install --defaults
    - ls -l angular-test | grep angular.json
    - ng version | grep {{version}}
  env:
    NG_CLI_ANALYTICS: false

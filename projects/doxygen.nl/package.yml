distributable:
  url: https://github.com/doxygen/doxygen/archive/refs/tags/Release_{{version.major}}_{{version.minor}}_{{version.patch}}.tar.gz
  strip-components: 1

versions:
  github: doxygen/doxygen/releases
  strip: /Doxygen release /

build:
  dependencies:
    gnu.org/bison: ^3
    cmake.org: ^3
    github.com/westes/flex: 2
    python.org: '>=3<3.12'
    linux:
      llvm.org: 20 # 21 has linking issues
  working-directory: build
  script:
    - cmake $ARGS -G "Unix Makefiles" ..
    - make --jobs {{ hw.concurrency }}
    - make install
  env:
    ARGS:
      - -DCMAKE_INSTALL_PREFIX="{{prefix}}"
      - -DCMAKE_BUILD_TYPE=Release

provides:
  - bin/doxygen

test:
  - doxygen -g
  - doxygen Doxyfile

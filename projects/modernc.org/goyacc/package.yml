distributable:
  url: https://gitlab.com/cznic/goyacc/-/archive/{{version.tag}}/{{version.tag}}.tar.gz
  strip-components: 1

display-name: modernc.org/goyacc

versions:
  gitlab: cznic/goyacc/tags

build:
  dependencies:
    rsync.samba.org: '*'
    go.dev: ^1.20
  env:
    CGO_ENABLED: 0
    GO_LDFLAGS:
    - -s
    - -w
    linux:
      GO_LDFLAGS:
      - -buildmode=pie
  script:
  - go build -v -ldflags="${GO_LDFLAGS}" -o "{{ prefix }}"/bin/goyacc
  - go test

provides:
- bin/goyacc

test: goyacc --help

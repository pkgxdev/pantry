distributable:
  url: https://github.com/bridgecrewio/checkov/archive/refs/tags/{{version}}.tar.gz
  strip-components: 1
versions:
  # github: bridgecrewio/checkov
  - 3.1.21
dependencies:
  python.org: ^3.12
build:
  script:
    - python-venv.sh {{prefix}}/bin/checkov
provides:
  - bin/checkov
test:
  - checkov --version | grep {{version}}
  - checkov -f test.tf > output.log
  - run: |
      cat output.log | grep 'Passed checks: 14, Failed checks: 0, Skipped checks: 0'
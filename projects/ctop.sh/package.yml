distributable:
  url: https://github.com/bcicen/ctop/archive/refs/tags/v{{version}}.tar.gz
  strip-components: 1

display-name: ctop.sh

versions:
  github: bcicen/ctop

build:
  dependencies:
    go.dev: ~1.18

  script:
    - go mod download
    - go build -tags release -ldflags="$GO_LDFLAGS" -o "$BUILDLOC"
  env:
    BUILDLOC: "{{prefix}}/bin/ctop"
    GO_LDFLAGS:
      - -s
      - -w
      - -X main.version={{version}}
      - -X main.build=pkgx
    linux:
      GO_LDFLAGS:
        - -buildmode=pie

provides:
  - bin/ctop

test: test "$(ctop -v | awk '{print $3}')" = {{version}},

distributable:
  url: https://git.kernel.org/pub/scm/libs/libcap/libcap.git/snapshot/libcap-{{version}}.tar.gz
  strip-components: 1

display-name: libcap

versions:
  url: https://git.kernel.org/pub/scm/libs/libcap/libcap.git/refs/
  match: /libcap-\d+\.\d+\.\d+\.tar\.gz/
  strip:
    - /^libcap-/
    - /.tar.gz$/

platforms:
  - linux

build:
  dependencies:
    gnu.org/binutils: '*'
    cmake.org: ^3
  env:
    linux:
      LD_PATH: $(which ld|sed 's/\//\\\//g')
  script:
    - sed -i 's/\/usr\/bin\/ld/'${LD_PATH}'/' Make.Rules
    - make prefix={{prefix}} --jobs {{ hw.concurrency }} install
    - mv sbin bin

provides:
  - bin/capsh
  - bin/captree
  - bin/getcap
  - bin/getpcaps
  - bin/setcap

test: test "$(getpcaps --license|head -1)" = '--license see LICENSE file for details.'


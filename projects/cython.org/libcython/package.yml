distributable:
  url: https://github.com/cython/cython/releases/download/{{version}}/Cython-{{version}}.tar.gz
  strip-components: 1
versions:
  github: cython/cython
dependencies:
  python.org: ^3.11
  linux:
    tea.xyz/gx/cc: c99
runtime:
  env:
    PYTHONPATH: "{{prefix}}/lib/python{{deps.python.org.version.marketing}}/site-packages:$PYTHONPATH"
build:
  script:
    - python3 setup.py install $ARGS
    - run: mv -f {{prefix}}/lib/python{{deps.python.org.version.marketing}}/site-packages/*/* {{prefix}}/lib/python{{deps.python.org.version.marketing}}/site-packages/
      if: linux
    - run: ln -s python{{deps.python.org.version.marketing}} python{{deps.python.org.version.major}}
      working-directory: "{{prefix}}/lib"
  env:
    ARGS:
      - --verbose
      - --prefix={{prefix}}
test:
  script:
    - python3 setup.py build_ext --inplace
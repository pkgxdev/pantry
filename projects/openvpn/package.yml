distributable:
  url: https://swupdate.openvpn.org/community/releases/openvpn-{{version}}.tar.gz
  strip-components: 1

versions:
  - 2.6.2

dependencies:
  lz4.org: ^1.9
  oberhumer.com/lzo: ^2.10
  openssl.org: ^1.1
  linux:
    sourceforge.net/net-tools: '*'
    github.com/thom311/libnl: '*'
  

build:
  dependencies:
    tea.xyz/gx/cc: c99
    tea.xyz/gx/make: '*'
    freedesktop.org/pkg-config: ^0.29
    linux:
      sourceforge.net/net-tools: '*'
      github.com/thom311/libnl: '*'
    # TODO: brew has pkcs11-helper: ~1.29, libcap-ng, linux-pam
  script: |
    ./configure $ARGS
    make --jobs {{ hw.concurrency }} install
  env:
    # add any environment variables here
    ARGS:
      - --prefix="{{prefix}}"
      - --disable-debug
      - --disable-dependency-tracking
      - --disable-silent-rules
      - --with-crypto-library=openssl
      - --disable-pkcs11

provides:
  - bin/openvpn 

test:
  script:
    openvpn --show-ciphers

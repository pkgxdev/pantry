distributable:
  url: https://github.com/CocoaPods/Xcodeproj/archive/refs/tags/{{version}}.tar.gz
  strip-components: 1

versions:
  github: CocoaPods/Xcodeproj/tags

dependencies:
  ruby-lang.org: ~3.2
  rubygems.org: ^3

build:
  env:
    GEM_HOME: ${{prefix}}
    GEM_PATH: ${{prefix}}
  script: |
    gem build xcodeproj.gemspec

    gem install \
      --no-user-install \
      --bindir={{prefix}}/gems/bin \
      --no-document \
      xcodeproj-{{version}}.gem

    mkdir -p "{{prefix}}"/bin
    chmod +x props/xcodeproj
    mv props/xcodeproj "{{prefix}}"/bin

provides:
  - bin/xcodeproj

test:
  script:
    test "$(xcodeproj --version)" = {{version}}
distributable:
  url: https://dev.yorhel.nl/download/ncdu-{{ version }}.tar.gz
  strip-components: 1

provides:
  - bin/ncdu

versions:
  - 2.2.2

dependencies:
  invisible-island.net/ncurses: '*'
  tea.xyz/gx/make: '*'

build:
  dependencies:
    ziglang.org: ~0.10
  script: zig build $ARGS
  env:
    ARGS:
      - --prefix {{ prefix }}
      - -Drelease-safe=true
      - --search-prefix "{{ deps.invisible-island.net/ncurses.prefix }}"
    linux:
      CFLAGS: -fPIC
      CXXFLAGS: -fPIC
      LDFLAGS: -pie

test: |
  ncdu -o test
  cat test

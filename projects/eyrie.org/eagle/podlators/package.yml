distributable:
  url: https://archives.eyrie.org/software/perl/podlators-{{version.raw}}.tar.xz
  strip-components: 1
display-name: pod2man
versions:
  url: https://archives.eyrie.org/software/perl/
  match: /podlators-\d+\.\d+\.tar\.xz/
  strip:
    - /^podlators-/
    - /\.tar\.xz/
runtime:
  env:
    PERL5LIB: "{{prefix}}/lib/perl5:{{prefix}}/libexec/lib/perl5"
build:
  dependencies:
    tea.xyz/gx/cc: c99
    gnu.org/make: '*'
    gnu.org/wget: '*'
  script:
    - wget https://cpan.metacpan.org/authors/id/B/BI/BINGOS/ExtUtils-MakeMaker-7.70.tar.gz
    - tar -xzf ExtUtils-MakeMaker-7.70.tar.gz
    - run: |
        perl Makefile.PL INSTALL_BASE={{prefix}}/libexec
        make --jobs {{ hw.concurrency }}
        make --jobs {{ hw.concurrency }} install
      working-directory: ExtUtils-MakeMaker-7.70
    - wget https://cpan.metacpan.org/authors/id/K/KH/KHW/Pod-Simple-3.43.tar.gz
    - tar -xzf Pod-Simple-3.43.tar.gz
    - run: |
        perl Makefile.PL INSTALL_BASE={{prefix}}/libexec
        make --jobs {{ hw.concurrency }}
        make --jobs {{ hw.concurrency }} install
      working-drectory: Pod-Simple-3.43
    - perl Makefile.PL $ARGS
    - make --jobs {{ hw.concurrency }}
    - make --jobs {{ hw.concurrency }} install
  env:
    PERL5LIB: "{{prefix}}/libexec/lib/perl5"
    ARGS:
      - INSTALL_BASE={{prefix}}
      - INSTALLSITEMAN1DIR={{prefix}}/man/man1
      - INSTALLSITEMAN3DIR={{prefix}}/man/man3

provides:
  - bin/pod2man
  - bin/pod2text
test:
  script:
    - pod2man test.pod | grep 'Pod::Man {{version.major}}'
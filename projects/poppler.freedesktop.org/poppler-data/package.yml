distributable:
  url: https://poppler.freedesktop.org/poppler-data-{{version}}.tar.gz
  strip-components: 1

versions:
  url: https://gitlab.freedesktop.org/api/v4/projects/883/repository/tags
  match: /"title":"\d+\.\d+\.\d+"/
  strip:
    - /^"title":"/
    - /"$/

build:
  dependencies:
    tea.xyz/gx/make: '*'
  script: |
    # datadir is for pkgconfig files, needed by poppler itself to find its own data files
    make install prefix={{prefix}} datadir={{prefix}}/lib pkgdatadir={{prefix}}/share/poppler

    # create a symlink in case something is expecting the .pc in share
    ln -s {{prefix}}/lib/pkgconfig {{prefix}}/share/

test:
  dependencies:
    freedesktop.org/pkg-config: '*'
  script: |
    pkg-config --cflags poppler-data

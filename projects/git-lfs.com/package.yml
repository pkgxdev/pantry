distributable:
  url: https://github.com/git-lfs/git-lfs/releases/download/v{{version}}/git-lfs-v{{version}}.tar.gz
  strip-components: 1

versions:
  github: git-lfs/git-lfs/releases/tags

provides:
  - bin/git-lfs

dependencies:
  git-scm.org: '*'

build:
  dependencies:
    tea.xyz/gx/cc: c99
    tea.xyz/gx/make: '*'
    go.dev: '*'
    git-scm.org: '*'
    asciidoctor.org: '*'
    rtomayko.github.io/ronn: '*'
  script: |
    make --jobs {{ hw.concurrency }}
    mkdir -p {{ prefix }}
    mv bin {{ prefix }}/bin
    make man
    mv man {{ prefix }}/man
    make test
  env:
    GIT_LFS_SHA: "{{ version }}"
    VERSION: "{{ version }}"

test:
  script: |
    git init
    git lfs track test
    git lfs version
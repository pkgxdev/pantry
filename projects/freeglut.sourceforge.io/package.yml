distributable:
  url: https://github.com/FreeGLUTProject/freeglut/releases/download/v{{version}}/freeglut-{{version}}.tar.gz
  strip-components: 1

versions:
  github: FreeGLUTProject/freeglut

dependencies:
  x.org/x11: '*'
  #x.org/xi: '*'
  #x.org/xrandr: '*'
  #x.org/xxf86vm: '*'
  #mesa3d.org: '*'
  linux:
    #cgit.freedesktop.org/mesa/glu: '*'
    #gitlab.freedesktop.org/xorg/app/xinput: '*'

build:
  dependencies:
    tea.xyz/gx/cc: c99
    tea.xyz/gx/make: '*'
    cmake.org: '*'
  script:
    - cmake $ARGS .
    - make --jobs {{ hw.concurrency }} all
    - make --jobs {{ hw.concurrency }} install

  env:
    ARGS:
      - -DFREEGLUT_BUILD_DEMOS=OFF
      - -DOPENGL_INCLUDE_DIR={{prefix}}/include
      - -DOPENGL_gl_LIBRARY={{prefix}}/lib/share/libGL
      - -DCMAKE_INSTALL_PREFIX={{prefix}}
      - -DCMAKE_INSTALL_LIBDIR=lib
      - -DCMAKE_BUILD_TYPE=Release
      - -DCMAKE_FIND_FRAMEWORK=LAST
      - -DCMAKE_VERBOSE_MAKEFILE=ON
      - -Wno-dev
      - -DBUILD_TESTING=OFF

test:
  dependencies:
    freedesktop.org/pkg-config: '*'
  script: pkg-config --modversion glut | grep {{version}}